function l(){import.meta.url,import("_").catch(()=>1),async function*(){}().next()}class n{constructor(t){if(typeof petitionerCaptcha<"u"&&petitionerCaptcha.recaptchaSiteKey){const e=t.querySelector('[name="petitioner-g-recaptcha-response"]');t.addEventListener("focusin",function(){e&&e.value||typeof grecaptcha>"u"||typeof(grecaptcha==null?void 0:grecaptcha.ready)>"u"||grecaptcha.ready(function(){grecaptcha.execute(petitionerCaptcha.recaptchaSiteKey,{}).then(i=>{e&&(e.value=i)})})},{once:!0})}else console.error("petitioner - reCAPTCHA site key is missing or reCAPTCHA failed to load.")}}class s{constructor(t){this.form=t,this.hcaptchaField=this.form.querySelector('[name="petitioner-h-captcha-response"]'),this.hcaptchaContainer=this.form.querySelector(".petitioner-h-captcha-container"),!(typeof hcaptcha>"u"||!(petitionerCaptcha!=null&&petitionerCaptcha.enableHcaptcha)||!(petitionerCaptcha!=null&&petitionerCaptcha.hcaptchaSiteKey)||!this.hcaptchaContainer)&&this.initHCaptcha()}initHCaptcha(){this.widgetId=hcaptcha.render(this.hcaptchaContainer,{sitekey:petitionerCaptcha.hcaptchaSiteKey,size:"invisible",callback:this.handleSuccess.bind(this)})}handleSuccess(t){if(!t){console.warn("❌ petitioner - hCaptcha token missing.");return}if(!this.hcaptchaField){console.error("❌ petitioner - hCaptcha input field not found.");return}this.hcaptchaField.value=t,typeof this.callbackFunction=="function"&&this.callbackFunction()}validate(t){if(!this.hcaptchaField||this.hcaptchaField.value){t();return}this.callbackFunction=t,hcaptcha.execute(this.widgetId)}}class o{constructor(t){this.form=t,this.turnstileField=this.form.querySelector('[name="petitioner-turnstile-response"]'),this.turnstileContainer=this.form.querySelector(".petitioner-turnstile-container"),!(typeof turnstile>"u"||!(petitionerCaptcha!=null&&petitionerCaptcha.turnstileSiteKey)||!this.turnstileContainer)&&this.initTurnstile()}initTurnstile(){this.widgetId=turnstile.render(this.turnstileContainer,{sitekey:petitionerCaptcha.turnstileSiteKey,callback:this.handleSuccess.bind(this),theme:"light","error-callback":this.handleError.bind(this)})}handleSuccess(t){if(!t){console.warn("❌ petitioner - Turnstile token missing.");return}if(!this.turnstileField){console.error("❌ petitioner - Turnstile input field not found.");return}this.turnstileField.value=t,typeof this.callbackFunction=="function"&&this.callbackFunction()}handleError(){console.error("❌ petitioner - Turnstile encountered an error.")}validate(t){if(!this.turnstileField||this.turnstileField.value){t();return}this.callbackFunction=t,turnstile.execute(this.widgetId)}}class c{constructor(t){var a;if(this.wrapper=t,!this.wrapper)return;this.responseTitle=this.wrapper.querySelector(".petitioner__response > h3"),this.responseText=this.wrapper.querySelector(".petitioner__response > p"),this.formEl=this.wrapper.querySelector("form"),this.viewLetterBTN=this.wrapper.querySelector(".petitioner__btn--letter"),this.petitionerModal=this.wrapper.querySelector(".petitioner-modal"),this.modalClose=this.wrapper.querySelector(".petitioner-modal__close"),this.backdrop=this.wrapper.querySelector(".petitioner-modal__backdrop");const{actionPath:e="",nonce:i=""}=window==null?void 0:window.petitionerFormSettings;this.actionPath=e||((a=this.formEl)==null?void 0:a.action)||"",this.nonce=i,this.captchaValidated=!1,petitionerCaptcha!=null&&petitionerCaptcha.enableRecaptcha&&new n(this.formEl),petitionerCaptcha!=null&&petitionerCaptcha.enableHcaptcha&&(this.hcaptcha=new s(this.formEl)),petitionerCaptcha!=null&&petitionerCaptcha.enableTurnstile&&(this.turnstile=new o(this.formEl)),this.formEl&&this.formEl.addEventListener("submit",this.handleFormSubmit.bind(this)),this.viewLetterBTN&&this.viewLetterBTN.addEventListener("click",()=>this.toggleModal(!0)),this.backdrop&&this.backdrop.addEventListener("click",()=>this.toggleModal(!1)),this.modalClose&&this.modalClose.addEventListener("click",()=>this.toggleModal(!1))}showResponseMSG(t="Something went wrong",e="Please try again",i=!1){this.wrapper.classList.add("petitioner--submitted"),this.responseTitle&&(this.responseTitle.innerText=t),this.responseText&&(this.responseText.innerText=e)}toggleModal(t=!0){this.petitionerModal&&this.petitionerModal.classList[t?"add":"remove"]("petitioner-modal--visible")}handleFormSubmit(t){if(t.preventDefault(),petitionerCaptcha!=null&&petitionerCaptcha.enableHcaptcha&&this.hcaptcha&&!this.captchaValidated){this.hcaptcha.validate(()=>{this.captchaValidated=!0,this.formEl.dispatchEvent(new Event("submit",{bubbles:!0,cancelable:!0}))});return}if(petitionerCaptcha!=null&&petitionerCaptcha.enableTurnstile&&this.turnstile&&!this.captchaValidated){this.turnstile.validate(()=>{this.captchaValidated=!0,this.formEl.dispatchEvent(new Event("submit",{bubbles:!0}))});return}this.wrapper.classList.add("petitioner--loading");const e=new FormData(this.formEl);e.append("petitioner_nonce",this.nonce),fetch(this.actionPath,{method:"POST",body:e,credentials:"same-origin",headers:{"X-Requested-With":"XMLHttpRequest"}}).then(i=>i.json()).then(i=>{i.success?this.showResponseMSG("Thank you!",i.data):this.showResponseMSG("Could not submit the form.",i.data),this.wrapper.classList.remove("petitioner--loading"),this.formEl.reset(),this.captchaValidated=!1;const a=new CustomEvent("petitionerFormSubmit",{detail:{formData:e}});document.dispatchEvent(a)}).catch(i=>{console.error("Error:",i),alert("An unexpected error occurred. Please try again later."),this.wrapper.classList.remove("petitioner--loading"),this.formEl.reset(),this.captchaValidated=!1})}}const h=document.querySelectorAll(".petitioner");h.forEach(r=>{new c(r)});window.location.search.includes("petitioner=confirmed")&&alert("Thank you for confirming your email!");window.location.search.includes("petitioner=invalid")&&alert("Something went wrong - could not confirm your email");export{l as __vite_legacy_guard};
