System.register(["./assets/utilities-legacy-Dw3x8UmL.js"],function(t,i){"use strict";var e;return{setters:[t=>{e=t.s}],execute:function(){var t=document.createElement("style");t.textContent=".petitioner{--ptr-color-primary: #e01a2b;--ptr-color-dark: #000000;--ptr-color-grey: #efefef;--ptr-fs-sm: 14px;--ptr-fs-md: 18px;--ptr-spacing-x: 16px;--ptr-spacing-y: 16px;--ptr-wrapper-bg: white;--ptr-wrapper-radius: 16px;--ptr-input-border-width: 1px;--ptr-input-border-color: #a1a1a1;--ptr-input-border-color-active: #00000;--ptr-input-border-radius: 8px;--ptr-input-spacing-y: .7rem;--ptr-input-spacing-x: 16px;--ptr-input-line-height: 40px;--ptr-label-font-size: var(--ptr-fs-sm);--ptr-btn-font-size: var(--ptr-fs-md);--ptr-btn-bg: var(--ptr-color-primary);--ptr-btn-bg-hover: var(--ptr-color-dark);--ptr-button-border-width: var(--ptr-input-border-width);--ptr-button-border-color: transparent;--ptr-button-border-color-active: var(--ptr-color-dark);--ptr-button-border-radius: 8px;--ptr-progress-height: 8px;--ptr-progress-bg: var(--ptr-color-grey);--ptr-progress-radius: 4px;--ptr-progress-inner-bg: var(--ptr-color-primary);--ptr-transition-duration: .2s;padding:var(--ptr-spacing-y) var(--ptr-spacing-x);background-color:var(--ptr-wrapper-bg);border-radius:var(--ptr-wrapper-radius);box-sizing:border-box}.petitioner__input{display:flex;flex-direction:column;gap:4px;margin-bottom:8px}.petitioner__input label{font-size:var(--ptr-label-font-size)}.petitioner__input input:not([type=checkbox]){outline:none;border-radius:var(--ptr-input-border-radius);border-color:var(--ptr-input-border-color);border-width:var(--ptr-input-border-width);padding:var(--ptr-input-spacing-y) var(--ptr-input-spacing-x);border-style:solid;font-size:var(--ptr-label-font-size);line-height:var(--ptr-input-line-height)}.petitioner__input input:not([type=checkbox]):focus{border-color:var(--ptr-input-border-color-active)}.petitioner__input select{outline:none;border-radius:var(--ptr-input-border-radius);border:var(--ptr-input-border-width) solid var(--ptr-input-border-color);padding:var(--ptr-input-spacing-y) var(--ptr-input-spacing-x);font-size:var(--ptr-label-font-size);background-color:var(--ptr-wrapper-bg);color:var(--ptr-color-dark);-webkit-appearance:none;appearance:none;background-image:url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23000000'%3E%3Cpath d='M7 10l5 5 5-5z'/%3E%3C/svg%3E\");background-repeat:no-repeat;background-position:right var(--ptr-input-spacing-x) center;background-size:1rem;cursor:pointer;transition:border-color var(--ptr-transition-duration),background-color var(--ptr-transition-duration);line-height:var(--ptr-input-line-height)}.petitioner__input select:focus{border-color:var(--ptr-input-border-color-active);box-shadow:0 0 3px rgba(0,0,0,.1)}.petitioner__input select:hover{background-color:var(--ptr-color-grey)}.petitioner__input select::placeholder{color:#aaa}.petitioner__input--checkbox{flex-direction:row;flex-wrap:nowrap;align-items:flex-start;margin-top:16px;margin-bottom:16px}.petitioner__input--checkbox label{order:1;display:inline-block;width:auto;transform:translatey(-3%)}.petitioner__input--checkbox label:hover{cursor:pointer}.petitioner__input--checkbox input[type=checkbox]{-webkit-appearance:none;appearance:none;width:var(--ptr-fs-md);height:var(--ptr-fs-md);border:var(--ptr-input-border-width) solid var(--ptr-input-border-color);border-radius:4px;background-color:var(--ptr-wrapper-bg);display:inline-block;cursor:pointer;transition:background-color var(--ptr-transition-duration),border-color var(--ptr-transition-duration);padding:0;flex-shrink:0}.petitioner__input--checkbox input[type=checkbox]:checked{background-color:var(--ptr-color-primary);border-color:var(--ptr-color-primary);background-image:url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='white' viewBox='0 0 24 24'%3E%3Cpath d='M20.285 6.707l-1.413-1.414L9.5 14.664 5.128 10.293 3.714 11.707 9.5 17.5z'/%3E%3C/svg%3E\");background-size:70%;background-position:center;background-repeat:no-repeat}.petitioner__input--checkbox input[type=checkbox]:focus{outline:none;box-shadow:0 0 3px rgba(0,0,0,.1)}.petitioner__btn{margin-top:4px;outline:none;border-radius:var(--ptr-button-border-radius);border-color:var(--ptr-button-border-color);border-width:var(--ptr-button-border-width);padding:var(--ptr-input-spacing-y) var(--ptr-input-spacing-x);border-style:solid;width:100%;background-color:var(--ptr-color-grey);transition:.1s;margin-bottom:16px}.petitioner__btn--submit{font-size:var(--ptr-fs-md);background-color:var(--ptr-color-primary);color:#fff}.petitioner__btn--submit:hover{background-color:var(--ptr-color-dark)}.petitioner__btn--letter{font-size:var(--ptr-fs-sm);background-color:var(--ptr-color-grey);color:var(--ptr-color-dark)}.petitioner__btn--letter:hover{background-color:var(--ptr-color-dark);color:#fff}.petitioner__btn:active,.petitioner__btn:focus{border-color:var(--ptr-button-border-color-active)}.petitioner__btn:hover{cursor:pointer}.petitioner__title{padding:0;margin:0 0 16px;font-size:24px}.petitioner__goal{width:100%;display:flex;flex-wrap:wrap;margin-top:24px;margin-bottom:24px}.petitioner__goal .petitioner__num{font-size:1rem;display:block;font-weight:700}.petitioner__goal .petitioner__numlabel{font-size:14px}.petitioner__goal .petitioner__col{width:50%;display:flex;flex-direction:column}.petitioner__goal .petitioner__col--end{align-items:flex-end}@media (min-width: 768px){.petitioner__goal .petitioner__num{font-size:1.5rem}.petitioner__goal .petitioner__numlabel{font-size:16px}}.petitioner__progress{width:100%;height:var(--ptr-progress-height);display:block;background-color:var(--ptr-progress-bg);border-radius:var(--ptr-progress-radius);position:relative}.petitioner__progress-bar{flex-grow:0;border-radius:var(--ptr-progress-radius);background-color:var(--ptr-progress-inner-bg);height:100%;display:block}.petitioner__progress-bar span{position:absolute;display:block;left:0;right:0;margin:0 auto;top:calc(-100% - 8px);font-size:14px;text-align:center}.petitioner__response{display:none}.petitioner__response h3{margin:0;padding:0}.petitioner--submitted form{display:none}.petitioner--submitted .petitioner__response{display:block}.petitioner--loading form{pointer-events:none;opacity:.8;cursor:progress}.petitioner .petitioner-disclaimer-text{font-size:12px}.grecaptcha-badge{visibility:hidden}.petitioner-modal{position:fixed;display:none;justify-content:center;align-items:center;left:0;top:0;width:100%;height:100%;z-index:99}.petitioner-modal--visible{display:flex}.petitioner-modal__backdrop{position:absolute;left:0;top:0;width:100%;height:100%;background-color:rgba(0,0,0,.5)}.petitioner-modal__close{position:absolute;right:8px;top:8px;z-index:2;background:transparent;outline:none;border:1px solid #ccc;padding:8px;border-radius:4px;line-height:1;width:24px;height:24px;display:flex;justify-content:center;align-items:center;transition:.1s;color:var(--ptr-color-dark)}.petitioner-modal__close:hover{cursor:pointer;background:var(--ptr-color-dark);color:#fff}.petitioner-modal__close span{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}.petitioner-modal hr{border:0px;height:1px;background:#ccc;margin-top:24px;margin-bottom:8px}.petitioner-modal__letter{position:relative;max-width:500px;background-color:#fff;border-radius:16px;padding:24px}.petitioner-modal__inner{max-height:40vh;overflow-y:auto}.petitioner-turnstile-container iframe{width:100%}.petitioner-submissions .submissions__item{display:inline}.petitioner-submissions .ptr-pagination{display:flex;justify-content:flex-start;align-items:center;margin-top:24px;gap:4px;flex-wrap:wrap}.petitioner-submissions .ptr-pagination button{background-color:var(--ptr-color-grey);border:none;border-radius:var(--ptr-input-border-radius);padding:var(--ptr-input-spacing-y) var(--ptr-input-spacing-x);cursor:pointer;font-size:var(--ptr-fs-sm);color:var(--ptr-color-dark);transition:background-color var(--ptr-transition-duration)}.petitioner-submissions .ptr-pagination button.active{background-color:var(--ptr-color-primary);color:#fff}.petitioner-submissions .ptr-pagination button:hover{background-color:var(--ptr-color-dark);color:#fff}.petitioner-submissions .ptr-pagination button[disabled]{background-color:var(--ptr-color-grey);color:var(--ptr-color-dark);opacity:.5;cursor:not-allowed}.petitioner-submissions--table{--ptr-submission-columns: 4}.petitioner-submissions--table .submissions__list{display:grid;grid-auto-rows:minmax(40px,auto)}.petitioner-submissions--table .submissions__item{display:contents}.petitioner-submissions--table .submissions__item--heading div{font-weight:700}.petitioner-submissions--table .submissions__item>div{display:block;padding:4px 8px;border-bottom:1px solid var(--ptr-color-grey);font-size:var(--ptr-fs-sm);word-break:break-word}.petitioner-submissions--table .submissions__list,.petitioner-submissions--table .submissions__heading{grid-template-columns:repeat(var(--ptr-submission-columns),1fr)}@media (max-width: 768px){.petitioner-submissions--table .submissions__list,.petitioner-submissions--table .submissions__heading{display:block}.petitioner-submissions--table .submissions__item{display:flex;flex-direction:column}.petitioner-submissions--table .submissions__item>div{border-bottom:none;padding:4px 0}}\n/*$vite$:1*/",document.head.appendChild(t);class i{constructor(t){if(void 0!==window.petitionerCaptcha&&window.petitionerCaptcha.recaptchaSiteKey){const i=t.querySelector('[name="petitioner-g-recaptcha-response"]');t.addEventListener("focusin",function(){i&&i.value||"undefined"!=typeof grecaptcha&&void 0!==grecaptcha?.ready&&grecaptcha.ready(function(){grecaptcha.execute(window.petitionerCaptcha.recaptchaSiteKey,{}).then(t=>{i&&(i.value=t)})})},{once:!0})}else console.error("petitioner - reCAPTCHA site key is missing or reCAPTCHA failed to load.")}}class r{constructor(t){this.widgetId=null,this.callbackFunction=null,this.form=t,this.hcaptchaField=this.form.querySelector('[name="petitioner-h-captcha-response"]'),this.hcaptchaContainer=this.form.querySelector(".petitioner-h-captcha-container"),this.isHCaptchaReady()&&this.initHCaptcha()}isHCaptchaReady(){return!!("undefined"!=typeof hcaptcha&&window.petitionerCaptcha?.enableHcaptcha&&window.petitionerCaptcha?.hcaptchaSiteKey&&this.hcaptchaContainer)}initHCaptcha(){hcaptcha&&window.petitionerCaptcha?.hcaptchaSiteKey&&this.hcaptchaContainer&&(this.widgetId=hcaptcha.render(this.hcaptchaContainer,{sitekey:window.petitionerCaptcha.hcaptchaSiteKey,size:"invisible",callback:this.handleSuccess.bind(this)}))}handleSuccess(t){t?this.hcaptchaField?(this.hcaptchaField.value=t,"function"==typeof this.callbackFunction&&this.callbackFunction()):console.error("❌ petitioner - hCaptcha input field not found."):console.warn("❌ petitioner - hCaptcha token missing.")}validate(t){this.hcaptchaField&&!this.hcaptchaField.value?(this.callbackFunction=t,hcaptcha&&this.widgetId&&hcaptcha.execute(this.widgetId)):t()}}class s{constructor(t){this.widgetId=null,this.callbackFunction=null,this.form=t,this.turnstileField=this.form.querySelector('[name="petitioner-turnstile-response"]'),this.turnstileContainer=this.form.querySelector(".petitioner-turnstile-container"),"undefined"!=typeof turnstile&&window.petitionerCaptcha?.turnstileSiteKey&&this.turnstileContainer&&this.initTurnstile()}initTurnstile(){this.widgetId=turnstile.render(this.turnstileContainer,{sitekey:petitionerCaptcha.turnstileSiteKey,callback:this.handleSuccess.bind(this),theme:"light","error-callback":this.handleError.bind(this)})}handleSuccess(t){t?this.turnstileField?(this.turnstileField.value=t,"function"==typeof this.callbackFunction&&this.callbackFunction()):console.error("❌ petitioner - Turnstile input field not found."):console.warn("❌ petitioner - Turnstile token missing.")}handleError(){console.error("❌ petitioner - Turnstile encountered an error.")}validate(t){this.turnstileField&&!this.turnstileField.value?(this.callbackFunction=t,turnstile.execute(this.widgetId)):t()}}class o{constructor(t){this.captchaValidated=!1,this.hcaptcha=null,this.turnstile=null,this._escListener=null,this.wrapper=t,this.responseTitle=null,this.responseText=null,this.formEl=null,this.viewLetterBTN=null,this.petitionerModal=null,this.modalClose=null,this.backdrop=null;const i=window?.petitionerFormSettings||{},{actionPath:e="",nonce:r=""}=i;this.actionPath=e||"",this.nonce=r,this.wrapper&&(this.responseTitle=this.wrapper.querySelector(".petitioner__response > h3"),this.responseText=this.wrapper.querySelector(".petitioner__response > p"),this.formEl=this.wrapper.querySelector("form"),this.viewLetterBTN=this.wrapper.querySelector(".petitioner__btn--letter"),this.petitionerModal=this.wrapper.querySelector(".petitioner-modal"),this.modalClose=this.wrapper.querySelector(".petitioner-modal__close"),this.backdrop=this.wrapper.querySelector(".petitioner-modal__backdrop"),this.initializeCaptcha(),this.setupEventListeners())}initializeCaptcha(){void 0!==window.petitionerCaptcha&&(window.petitionerCaptcha.enableRecaptcha&&this.formEl&&new i(this.formEl),window.petitionerCaptcha.enableHcaptcha&&this.formEl&&(this.hcaptcha=new r(this.formEl)),window.petitionerCaptcha.enableTurnstile&&this.formEl&&(this.turnstile=new s(this.formEl)))}setupEventListeners(){this.formEl&&this.formEl.addEventListener("submit",this.handleFormSubmit.bind(this)),this.viewLetterBTN&&this.viewLetterBTN.addEventListener("click",()=>this.toggleModal(!0)),this.backdrop&&this.backdrop.addEventListener("click",()=>this.toggleModal(!1)),this.modalClose&&this.modalClose.addEventListener("click",()=>this.toggleModal(!1))}showResponseMSG(t,i=!1){this.wrapper.classList.add("petitioner--submitted");const{title:e,message:r}=t||{title:"",message:""};this.responseTitle&&(this.responseTitle.innerText=e),this.responseText&&(this.responseText.innerHTML=r)}toggleModal(t=!0){this.petitionerModal&&(this.petitionerModal.classList[t?"add":"remove"]("petitioner-modal--visible"),t?(this._escListener=t=>{"Escape"===t.key&&this.toggleModal(!1)},document.addEventListener("keydown",this._escListener)):this._escListener&&(document.removeEventListener("keydown",this._escListener),this._escListener=null))}handleFormSubmit(t){t.preventDefault(),this.shouldValidateHCaptcha()?this.hcaptcha.validate(()=>{this.captchaValidated=!0,this.submitForm()}):this.shouldValidateTurnstile()?this.turnstile.validate(()=>{this.captchaValidated=!0,this.submitForm()}):this.submitForm()}shouldValidateHCaptcha(){return!(!petitionerCaptcha?.enableHcaptcha||!this.hcaptcha||this.captchaValidated)}shouldValidateTurnstile(){return!(!petitionerCaptcha?.enableTurnstile||!this.turnstile||this.captchaValidated)}submitForm(){if(!this.formEl)return;this.wrapper.classList.add("petitioner--loading");const t=new FormData(this.formEl);t.append("petitioner_nonce",this.nonce),fetch(this.actionPath,{method:"POST",body:t,credentials:"same-origin",headers:{"X-Requested-With":"XMLHttpRequest"}}).then(t=>{if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);return t.json()}).then(i=>{i.success?this.showResponseMSG(i.data,!0):this.showResponseMSG(i.data,!1),this.handleSubmissionComplete(t)}).catch(t=>{console.error("Error:",t),alert("An unexpected error occurred. Please try again later."),this.handleSubmissionComplete()})}handleSubmissionComplete(t){if(this.wrapper.classList.remove("petitioner--loading"),this.formEl?.reset(),this.captchaValidated=!1,t){const i=new CustomEvent("petitionerFormSubmit",{detail:{formData:t}});document.dispatchEvent(i)}}}class n{constructor(t){if(this.options=t,this.options.currentPage=this.options.currentPage||1,this.submissionListDiv=document.createElement("div"),this.submissionListDiv.className="submissions__list",this.paginationDiv=document.createElement("div"),this.paginationDiv.className="submissions__pagination",!this.options.wrapper)throw new Error("Element not found")}attachEventListeners(){this.paginationDiv&&this.paginationDiv.addEventListener("click",async t=>{const i=t.target;if("BUTTON"===i.tagName){const t=parseInt(i.dataset.page||"1",10);if(!isNaN(t)){this.options.currentPage=t;const i=await this.options.onPageChange(t);this.options.submissions=i,this.update()}}})}render(){this.options.submissions&&(this.options.wrapper.appendChild(this.submissionListDiv),this.options.wrapper.appendChild(this.paginationDiv),this.submissionListDiv.innerHTML=this.renderSubmissionsList(),this.paginationDiv.innerHTML=this.renderPagination(),this.attachEventListeners())}update(){this.submissionListDiv.innerHTML=this.renderSubmissionsList(),this.paginationDiv.querySelectorAll(".active").forEach(t=>{t.classList.remove("active")}),this.paginationDiv.querySelector(`[data-page="${this.options.currentPage}"]`)?.classList.add("active")}renderSubmissionsList(){return this.options.submissions&&0!==this.options.submissions.length?this.options.submissions.map(t=>this.renderSubmissionItem(t)).join(", "):""}renderSubmissionItem(t){return`<span class="submissions__item">${t.name}</span>`}renderPagination(){if(!this.options.total||!this.options.perPage||!this.options.pagination)return"";const t=Math.ceil(this.options.total/this.options.perPage);if(t<=1)return"";let i='<div class="ptr-pagination">';for(let e=1;e<=t;e++)i+=`<button class="ptr-pagination__item ${e===this.options.currentPage?"active":""}" data-page="${e}">${e}</button>`;return i+="</div>",i}}class a extends n{constructor(t){super(t),this.options=t}render(){this.options.submissions&&(this.options.wrapper.appendChild(this.submissionListDiv),this.options.wrapper.appendChild(this.paginationDiv),this.options.wrapper.style=this.getWrapperStyles(),this.submissionListDiv.innerHTML=this.renderSubmissionsList(),this.paginationDiv.innerHTML=this.renderPagination(),this.attachEventListeners())}renderSubmissionsList(){if(!this.options.submissions||0===this.options.submissions.length)return"";const t=this.prepareLabels(),i=this.options.submissions.map(t=>this.renderSubmissionItem(t)).join("");return`\n\t\t<div class="submissions__item submissions__item--heading">\n\t\t\t${t.map(t=>`<div>${t}</div>`).join("")}\n\t\t</div>\n\t\t${i}`}prepareLabels(){const t=[],i=this.options.submissions[0];return Object.keys(i).forEach(i=>{this.options.labels?.[i]&&this.options.fields.includes(i)&&t.push(this.options.labels?.[i])}),t}renderSubmissionItem(t){return`<div class="submissions__item">\n\t\t\t${Object.keys(t).filter(t=>t in this.options.labels&&this.options.fields.includes(t)).map(i=>`<div>${"fname"===i?`${t.fname} ${t.lname}`:t?.[i]}</div>`).join("")}\n\t\t</div>`}getWrapperStyles(){return`--ptr-submission-columns: ${this.prepareLabels().length}`}}class p{constructor(t){if(this.wrapper=t,this.currentPage=1,this.totalResults=10,!this.wrapper)throw new Error("Element not found");const i=this.wrapper.dataset.ptrSettings;if(this.ajaxurl=window?.petitionerSubmissionSettings?.actionPath||"",this.nonce=window?.petitionerSubmissionSettings?.nonce||"",this.labels={},!this.ajaxurl||!this.nonce)throw new Error("AJAX URL or nonce is not defined in settings");if(!i)throw new Error("Wrapper is missing data-ptr-settings attribute");const r=e(i);if(!(r&&"object"==typeof r&&r.form_id&&r.per_page&&r.style))throw new Error("Invalid settings provided for PetitionerSubmissions");this.settings=r,this.init()}async init(){if(this.settings&&(await this.fetchSubmissions(),"object"==typeof this.submissions&&this.submissions?.length>0)){const t="simple"===this.settings.style?n:a;this.renderer=new t({wrapper:this.wrapper,submissions:this.submissions,perPage:this.settings.per_page,total:this.totalResults,currentPage:this.currentPage,labels:this.labels,fields:this.settings.fields?this.settings.fields.split(",").map(t=>t.trim()):[],pagination:this.settings.show_pagination,onPageChange:async t=>(this.currentPage=t,await this.fetchSubmissions(),this.submissions??[])}),this.renderer.render()}}buildURL(){const t=new URL(this.ajaxurl,window.location.origin);return t.searchParams.set("form_id",String(this.settings?.form_id)),t.searchParams.set("per_page",String(this.settings?.per_page)),t.searchParams.set("page",String(this.currentPage)),this.settings?.fields&&t.searchParams.set("fields",this.settings.fields),t.toString()}async fetchSubmissions(){const t=this.buildURL(),i=await fetch(t);if(!i.ok)throw new Error("Failed to fetch submissions");const e=await i.json();if(!e.success)throw new Error("Failed to fetch submissions: "+e.data);this.totalResults=Number(e.data.total)||0,this.submissions=e.data.submissions||[],this.labels=e.data.labels||[]}}document.querySelectorAll(".petitioner").forEach(t=>{t instanceof HTMLElement&&new o(t)}),document.querySelectorAll(".petitioner-submissions").forEach(t=>{t instanceof HTMLElement&&new p(t)}),window.location.search.includes("petitioner=confirmed")&&alert("Thank you for confirming your email!"),window.location.search.includes("petitioner=invalid")&&alert("Something went wrong - could not confirm your email")}}});
